{"ast":null,"code":"require(\"core-js/modules/es.error.cause.js\");\n\n/*\n    Copyright 2020 The caver-js Authors\n    This file is part of the caver-js library.\n\n    The caver-js library is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    The caver-js library is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with the caver-js. If not, see <http://www.gnu.org/licenses/>.\n*/\nconst _ = require('lodash');\n\nconst utils = require('../../../caver-utils/src');\n\nconst SignatureData = require('../../../caver-wallet/src/keyring/signatureData');\n/**\n * The transaction type strings.\n *\n * @example\n * caver.transaction.type.TxTypeLegacyTransaction\n * caver.transaction.type.TxTypeValueTransfer\n * caver.transaction.type.TxTypeFeeDelegatedValueTransfer\n * caver.transaction.type.TxTypeFeeDelegatedValueTransferWithRatio\n * caver.transaction.type.TxTypeValueTransferMemo\n * caver.transaction.type.TxTypeFeeDelegatedValueTransferMemo\n * caver.transaction.type.TxTypeFeeDelegatedValueTransferMemoWithRatio\n * caver.transaction.type.TxTypeAccountUpdate\n * caver.transaction.type.TxTypeFeeDelegatedAccountUpdate\n * caver.transaction.type.TxTypeFeeDelegatedAccountUpdateWithRatio\n * caver.transaction.type.TxTypeSmartContractDeploy\n * caver.transaction.type.TxTypeFeeDelegatedSmartContractDeploy\n * caver.transaction.type.TxTypeFeeDelegatedSmartContractDeployWithRatio\n * caver.transaction.type.TxTypeSmartContractExecution\n * caver.transaction.type.TxTypeFeeDelegatedSmartContractExecution\n * caver.transaction.type.TxTypeFeeDelegatedSmartContractExecutionWithRatio\n * caver.transaction.type.TxTypeCancel\n * caver.transaction.type.TxTypeFeeDelegatedCancel\n * caver.transaction.type.TxTypeFeeDelegatedCancelWithRatio\n * caver.transaction.type.TxTypeChainDataAnchoring\n * caver.transaction.type.TxTypeFeeDelegatedChainDataAnchoring\n * caver.transaction.type.TxTypeFeeDelegatedChainDataAnchoringWithRatio\n *\n * @alias module:Transaction.type\n * @type {Map<string:string>}\n */\n\n\nconst TX_TYPE_STRING = {\n  TxTypeLegacyTransaction: 'TxTypeLegacyTransaction',\n  TxTypeValueTransfer: 'TxTypeValueTransfer',\n  TxTypeFeeDelegatedValueTransfer: 'TxTypeFeeDelegatedValueTransfer',\n  TxTypeFeeDelegatedValueTransferWithRatio: 'TxTypeFeeDelegatedValueTransferWithRatio',\n  TxTypeValueTransferMemo: 'TxTypeValueTransferMemo',\n  TxTypeFeeDelegatedValueTransferMemo: 'TxTypeFeeDelegatedValueTransferMemo',\n  TxTypeFeeDelegatedValueTransferMemoWithRatio: 'TxTypeFeeDelegatedValueTransferMemoWithRatio',\n  TxTypeAccountUpdate: 'TxTypeAccountUpdate',\n  TxTypeFeeDelegatedAccountUpdate: 'TxTypeFeeDelegatedAccountUpdate',\n  TxTypeFeeDelegatedAccountUpdateWithRatio: 'TxTypeFeeDelegatedAccountUpdateWithRatio',\n  TxTypeSmartContractDeploy: 'TxTypeSmartContractDeploy',\n  TxTypeFeeDelegatedSmartContractDeploy: 'TxTypeFeeDelegatedSmartContractDeploy',\n  TxTypeFeeDelegatedSmartContractDeployWithRatio: 'TxTypeFeeDelegatedSmartContractDeployWithRatio',\n  TxTypeSmartContractExecution: 'TxTypeSmartContractExecution',\n  TxTypeFeeDelegatedSmartContractExecution: 'TxTypeFeeDelegatedSmartContractExecution',\n  TxTypeFeeDelegatedSmartContractExecutionWithRatio: 'TxTypeFeeDelegatedSmartContractExecutionWithRatio',\n  TxTypeCancel: 'TxTypeCancel',\n  TxTypeFeeDelegatedCancel: 'TxTypeFeeDelegatedCancel',\n  TxTypeFeeDelegatedCancelWithRatio: 'TxTypeFeeDelegatedCancelWithRatio',\n  TxTypeChainDataAnchoring: 'TxTypeChainDataAnchoring',\n  TxTypeFeeDelegatedChainDataAnchoring: 'TxTypeFeeDelegatedChainDataAnchoring',\n  TxTypeFeeDelegatedChainDataAnchoringWithRatio: 'TxTypeFeeDelegatedChainDataAnchoringWithRatio',\n  TxTypeEthereumAccessList: 'TxTypeEthereumAccessList',\n  TxTypeEthereumDynamicFee: 'TxTypeEthereumDynamicFee'\n};\n/**\n * The transaction tag hex strings.\n * This is because the transaction type tag string and the transaction type string are mapped, so the transaction type tag can be used as a key value.\n *\n * @example\n * caver.transaction.tag.TxTypeLegacyTransaction // caver.transaction.tag['']\n * caver.transaction.tag.TxTypeValueTransfer // caver.transaction.tag['0x08']\n * caver.transaction.tag.TxTypeFeeDelegatedValueTransfer // caver.transaction.tag['0x09']\n * caver.transaction.tag.TxTypeFeeDelegatedValueTransferWithRatio // caver.transaction.tag['0x0a']\n * caver.transaction.tag.TxTypeValueTransferMemo // caver.transaction.tag['0x10']\n * caver.transaction.tag.TxTypeFeeDelegatedValueTransferMemo // caver.transaction.tag['0x11']\n * caver.transaction.tag.TxTypeFeeDelegatedValueTransferMemoWithRatio // caver.transaction.tag['0x12']\n * caver.transaction.tag.TxTypeAccountUpdate // caver.transaction.tag['0x20']\n * caver.transaction.tag.TxTypeFeeDelegatedAccountUpdate // caver.transaction.tag['0x21']\n * caver.transaction.tag.TxTypeFeeDelegatedAccountUpdateWithRatio // caver.transaction.tag['0x22']\n * caver.transaction.tag.TxTypeSmartContractDeploy // caver.transaction.tag['0x28']\n * caver.transaction.tag.TxTypeFeeDelegatedSmartContractDeploy // caver.transaction.tag['0x29']\n * caver.transaction.tag.TxTypeFeeDelegatedSmartContractDeployWithRatio // caver.transaction.tag['0x2a']\n * caver.transaction.tag.TxTypeSmartContractExecution // caver.transaction.tag['0x30']\n * caver.transaction.tag.TxTypeFeeDelegatedSmartContractExecution // caver.transaction.tag['0x31']\n * caver.transaction.tag.TxTypeFeeDelegatedSmartContractExecutionWithRatio // caver.transaction.tag['0x32']\n * caver.transaction.tag.TxTypeCancel // caver.transaction.tag['0x38']\n * caver.transaction.tag.TxTypeFeeDelegatedCancel // caver.transaction.tag['0x39']\n * caver.transaction.tag.TxTypeFeeDelegatedCancelWithRatio // caver.transaction.tag['0x3a']\n * caver.transaction.tag.TxTypeChainDataAnchoring // caver.transaction.tag['0x48']\n * caver.transaction.tag.TxTypeFeeDelegatedChainDataAnchoring // caver.transaction.tag['0x49']\n * caver.transaction.tag.TxTypeFeeDelegatedChainDataAnchoringWithRatio // caver.transaction.tag['0x4a']\n *\n * @alias module:Transaction.type\n * @type {Map<string:string>}\n */\n\nconst TX_TYPE_TAG = {\n  TxTypeLegacyTransaction: '',\n  '': TX_TYPE_STRING.TxTypeLegacyTransaction,\n  TxTypeValueTransfer: '0x08',\n  '0x08': TX_TYPE_STRING.TxTypeValueTransfer,\n  TxTypeFeeDelegatedValueTransfer: '0x09',\n  '0x09': TX_TYPE_STRING.TxTypeFeeDelegatedValueTransfer,\n  TxTypeFeeDelegatedValueTransferWithRatio: '0x0a',\n  '0x0a': TX_TYPE_STRING.TxTypeFeeDelegatedValueTransferWithRatio,\n  TxTypeValueTransferMemo: '0x10',\n  '0x10': TX_TYPE_STRING.TxTypeValueTransferMemo,\n  TxTypeFeeDelegatedValueTransferMemo: '0x11',\n  '0x11': TX_TYPE_STRING.TxTypeFeeDelegatedValueTransferMemo,\n  TxTypeFeeDelegatedValueTransferMemoWithRatio: '0x12',\n  '0x12': TX_TYPE_STRING.TxTypeFeeDelegatedValueTransferMemoWithRatio,\n  TxTypeAccountUpdate: '0x20',\n  '0x20': TX_TYPE_STRING.TxTypeAccountUpdate,\n  TxTypeFeeDelegatedAccountUpdate: '0x21',\n  '0x21': TX_TYPE_STRING.TxTypeFeeDelegatedAccountUpdate,\n  TxTypeFeeDelegatedAccountUpdateWithRatio: '0x22',\n  '0x22': TX_TYPE_STRING.TxTypeFeeDelegatedAccountUpdateWithRatio,\n  TxTypeSmartContractDeploy: '0x28',\n  '0x28': TX_TYPE_STRING.TxTypeSmartContractDeploy,\n  TxTypeFeeDelegatedSmartContractDeploy: '0x29',\n  '0x29': TX_TYPE_STRING.TxTypeFeeDelegatedSmartContractDeploy,\n  TxTypeFeeDelegatedSmartContractDeployWithRatio: '0x2a',\n  '0x2a': TX_TYPE_STRING.TxTypeFeeDelegatedSmartContractDeployWithRatio,\n  TxTypeSmartContractExecution: '0x30',\n  '0x30': TX_TYPE_STRING.TxTypeSmartContractExecution,\n  TxTypeFeeDelegatedSmartContractExecution: '0x31',\n  '0x31': TX_TYPE_STRING.TxTypeFeeDelegatedSmartContractExecution,\n  TxTypeFeeDelegatedSmartContractExecutionWithRatio: '0x32',\n  '0x32': TX_TYPE_STRING.TxTypeFeeDelegatedSmartContractExecutionWithRatio,\n  TxTypeCancel: '0x38',\n  '0x38': TX_TYPE_STRING.TxTypeCancel,\n  TxTypeFeeDelegatedCancel: '0x39',\n  '0x39': TX_TYPE_STRING.TxTypeFeeDelegatedCancel,\n  TxTypeFeeDelegatedCancelWithRatio: '0x3a',\n  '0x3a': TX_TYPE_STRING.TxTypeFeeDelegatedCancelWithRatio,\n  TxTypeChainDataAnchoring: '0x48',\n  '0x48': TX_TYPE_STRING.TxTypeChainDataAnchoring,\n  TxTypeFeeDelegatedChainDataAnchoring: '0x49',\n  '0x49': TX_TYPE_STRING.TxTypeFeeDelegatedChainDataAnchoring,\n  TxTypeFeeDelegatedChainDataAnchoringWithRatio: '0x4a',\n  '0x4a': TX_TYPE_STRING.TxTypeFeeDelegatedChainDataAnchoringWithRatio,\n  TxTypeEthereumAccessList: '0x7801',\n  '0x7801': TX_TYPE_STRING.TxTypeEthereumAccessList,\n  TxTypeEthereumDynamicFee: '0x7802',\n  '0x7802': TX_TYPE_STRING.TxTypeEthereumDynamicFee\n};\nconst CODE_FORMAT = {\n  EVM: '0x0'\n};\n/**\n * Returns transaction type number.\n *\n * @param {string} type - A transaction type string.\n * @return {number}\n */\n\nconst getTypeInt = type => {\n  return utils.hexToNumber(TX_TYPE_TAG[type]);\n};\n/**\n * Returns an EthereumTxTypeEnvelopeTag string.\n * This will be used to RLP encode ethereum typed transactions as a type prefix.\n *\n * @return {string}\n */\n\n\nconst getEthereumTxTypeEnvelopeTag = () => {\n  return '0x78';\n};\n/**\n * Returns an ethereum type tag without EthereumTxTypeEnvelopeTag('0x78').\n * This will be used to get RLP encoding to sign the ethereum typed transactions.\n *\n * @param {string} type - A transaction type string or tag.\n * @return {string}\n */\n\n\nconst getTypeTagWithoutEthereumTxTypeEnvelopeTag = type => {\n  if (!isEthereumTypedTxType(type)) throw new Error(`Not EthereumTxTypeEnvelope tx type: ${type}`);\n  let tag = type;\n  if (type.startsWith('TxType')) tag = TX_TYPE_TAG[type];\n  return `0x${tag.replace(getEthereumTxTypeEnvelopeTag(), '')}`;\n};\n/**\n * Returns whether the transaction type is ethereum tx or not.\n *\n * @param {string} type - A transaction type string or tag.\n * @return {boolean}\n */\n\n\nconst isEthereumTxType = txType => {\n  // The transaction types in `caver.transaction` should have tx type string as a member variable.\n  // So here we don't assume, user can define undefined for tx type.\n  if (txType === undefined) return false;\n  return isLegacyTxType(txType) || isEthereumTypedTxType(txType);\n};\n/**\n * Returns whether the transaction type is legacy tx or not.\n *\n * @param {string} type - A transaction type string or tag.\n * @return {boolean}\n */\n\n\nconst isLegacyTxType = txType => {\n  // The transaction types in `caver.transaction` should have tx type string as a member variable.\n  // So here we don't assume, user can define undefined for tx type.\n  if (txType === undefined) return false;\n  return txType === TX_TYPE_STRING.TxTypeLegacyTransaction || txType === TX_TYPE_TAG.TxTypeLegacyTransaction;\n};\n/**\n * Returns the transaction type is ethereum typed tx or not.\n *\n * @param {string} type - A transaction type string or tag.\n * @return {boolean}\n */\n\n\nconst isEthereumTypedTxType = txType => {\n  // The transaction types in `caver.transaction` should have tx type string as a member variable.\n  // So here we don't assume, user can define undefined for tx type.\n  if (txType === undefined) return false;\n  return txType.startsWith(getEthereumTxTypeEnvelopeTag()) || txType === TX_TYPE_STRING.TxTypeEthereumAccessList || txType === TX_TYPE_STRING.TxTypeEthereumDynamicFee;\n};\n/**\n * Refines the array containing signatures.\n * - Removes duplicate signatures.\n * - Removes the default empty signature(['0x01', '0x', '0x']) included with other signatures.\n * - For an empty signature array, return an array containing the default empty signature(['0x01', '0x', '0x']).\n *\n * @param {Array.<string>|Array.<Array.<string>>|SignatureData|Array.<SignatureData>} sigArray - A signature or an array of signatures.\n * @param {string} [txType] - The transaction type string. This can be null if signature is not for transaction(for example message signed).\n * @return {SignatureData|Array.<SignatureData>}\n */\n\n\nconst refineSignatures = (sigArray, txType) => {\n  const set = new Set();\n  let result = [];\n  const isSingleSignature = txType !== undefined ? isEthereumTxType(txType) : false;\n  let arrayOfSignatures = sigArray;\n\n  if (!_.isArray(sigArray) && sigArray instanceof SignatureData) {\n    arrayOfSignatures = [sigArray];\n  } else if (_.isArray(sigArray) && _.isString(sigArray[0])) {\n    arrayOfSignatures = [sigArray];\n  }\n\n  for (const sig of arrayOfSignatures) {\n    const signatureData = new SignatureData(sig);\n\n    if (!signatureData.isEmpty()) {\n      const sigString = sig.toString();\n\n      if (!set.has(sigString)) {\n        set.add(sigString, true);\n        result.push(signatureData);\n      }\n    }\n  }\n\n  if (result.length === 0) result = [SignatureData.emtpySig];\n  if (isSingleSignature && txType != undefined && result.length > 1) throw new Error(`${txType}} cannot have multiple sigantures.`);\n  return !isSingleSignature ? result : result[0];\n};\n/**\n * Returns transaction type string.\n *\n * @param {string} rlpEncoded - An RLP-encoded transaction string.\n * @return {string}\n */\n\n\nconst typeDetectionFromRLPEncoding = rlpEncoded => {\n  rlpEncoded = utils.addHexPrefix(rlpEncoded);\n  let typeTag;\n\n  if (rlpEncoded.startsWith(getEthereumTxTypeEnvelopeTag())) {\n    typeTag = rlpEncoded.slice(0, 6);\n  } else {\n    typeTag = rlpEncoded.slice(0, 4);\n  }\n\n  return TX_TYPE_TAG[typeTag] ? TX_TYPE_TAG[typeTag] : TX_TYPE_STRING.TxTypeLegacyTransaction;\n};\n/**\n * Returns code format tag string.\n *\n * @param {string|number} cf - The code format.\n * @return {string}\n */\n\n\nconst getCodeFormatTag = cf => {\n  if (cf === undefined) return CODE_FORMAT.EVM;\n\n  switch (cf) {\n    case 0:\n    case '0x':\n    case '0x0':\n    case 'EVM':\n      return CODE_FORMAT.EVM;\n  }\n\n  throw new Error(`Unsupported code format : ${cf}`);\n};\n/**\n * Returns `true` value is undefined or null.\n *\n * @param {*} value - The value to check.\n * @return {string}\n */\n\n\nconst isNot = function (value) {\n  return _.isUndefined(value) || _.isNull(value);\n};\n\nmodule.exports = {\n  TX_TYPE_STRING,\n  TX_TYPE_TAG,\n  CODE_FORMAT,\n  isNot,\n  refineSignatures,\n  typeDetectionFromRLPEncoding,\n  getCodeFormatTag,\n  getTypeInt,\n  isEthereumTxType,\n  isEthereumTypedTxType,\n  getEthereumTxTypeEnvelopeTag,\n  getTypeTagWithoutEthereumTxTypeEnvelopeTag\n};","map":{"version":3,"sources":["/home/lorancecall/Projects/vuejs-tutorial/testpage/node_modules/caver-js/packages/caver-transaction/src/transactionHelper/transactionHelper.js"],"names":["_","require","utils","SignatureData","TX_TYPE_STRING","TxTypeLegacyTransaction","TxTypeValueTransfer","TxTypeFeeDelegatedValueTransfer","TxTypeFeeDelegatedValueTransferWithRatio","TxTypeValueTransferMemo","TxTypeFeeDelegatedValueTransferMemo","TxTypeFeeDelegatedValueTransferMemoWithRatio","TxTypeAccountUpdate","TxTypeFeeDelegatedAccountUpdate","TxTypeFeeDelegatedAccountUpdateWithRatio","TxTypeSmartContractDeploy","TxTypeFeeDelegatedSmartContractDeploy","TxTypeFeeDelegatedSmartContractDeployWithRatio","TxTypeSmartContractExecution","TxTypeFeeDelegatedSmartContractExecution","TxTypeFeeDelegatedSmartContractExecutionWithRatio","TxTypeCancel","TxTypeFeeDelegatedCancel","TxTypeFeeDelegatedCancelWithRatio","TxTypeChainDataAnchoring","TxTypeFeeDelegatedChainDataAnchoring","TxTypeFeeDelegatedChainDataAnchoringWithRatio","TxTypeEthereumAccessList","TxTypeEthereumDynamicFee","TX_TYPE_TAG","CODE_FORMAT","EVM","getTypeInt","type","hexToNumber","getEthereumTxTypeEnvelopeTag","getTypeTagWithoutEthereumTxTypeEnvelopeTag","isEthereumTypedTxType","Error","tag","startsWith","replace","isEthereumTxType","txType","undefined","isLegacyTxType","refineSignatures","sigArray","set","Set","result","isSingleSignature","arrayOfSignatures","isArray","isString","sig","signatureData","isEmpty","sigString","toString","has","add","push","length","emtpySig","typeDetectionFromRLPEncoding","rlpEncoded","addHexPrefix","typeTag","slice","getCodeFormatTag","cf","isNot","value","isUndefined","isNull","module","exports"],"mappings":"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","sourcesContent":["/*\n    Copyright 2020 The caver-js Authors\n    This file is part of the caver-js library.\n\n    The caver-js library is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    The caver-js library is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with the caver-js. If not, see <http://www.gnu.org/licenses/>.\n*/\n\nconst _ = require('lodash')\nconst utils = require('../../../caver-utils/src')\nconst SignatureData = require('../../../caver-wallet/src/keyring/signatureData')\n\n/**\n * The transaction type strings.\n *\n * @example\n * caver.transaction.type.TxTypeLegacyTransaction\n * caver.transaction.type.TxTypeValueTransfer\n * caver.transaction.type.TxTypeFeeDelegatedValueTransfer\n * caver.transaction.type.TxTypeFeeDelegatedValueTransferWithRatio\n * caver.transaction.type.TxTypeValueTransferMemo\n * caver.transaction.type.TxTypeFeeDelegatedValueTransferMemo\n * caver.transaction.type.TxTypeFeeDelegatedValueTransferMemoWithRatio\n * caver.transaction.type.TxTypeAccountUpdate\n * caver.transaction.type.TxTypeFeeDelegatedAccountUpdate\n * caver.transaction.type.TxTypeFeeDelegatedAccountUpdateWithRatio\n * caver.transaction.type.TxTypeSmartContractDeploy\n * caver.transaction.type.TxTypeFeeDelegatedSmartContractDeploy\n * caver.transaction.type.TxTypeFeeDelegatedSmartContractDeployWithRatio\n * caver.transaction.type.TxTypeSmartContractExecution\n * caver.transaction.type.TxTypeFeeDelegatedSmartContractExecution\n * caver.transaction.type.TxTypeFeeDelegatedSmartContractExecutionWithRatio\n * caver.transaction.type.TxTypeCancel\n * caver.transaction.type.TxTypeFeeDelegatedCancel\n * caver.transaction.type.TxTypeFeeDelegatedCancelWithRatio\n * caver.transaction.type.TxTypeChainDataAnchoring\n * caver.transaction.type.TxTypeFeeDelegatedChainDataAnchoring\n * caver.transaction.type.TxTypeFeeDelegatedChainDataAnchoringWithRatio\n *\n * @alias module:Transaction.type\n * @type {Map<string:string>}\n */\nconst TX_TYPE_STRING = {\n    TxTypeLegacyTransaction: 'TxTypeLegacyTransaction',\n\n    TxTypeValueTransfer: 'TxTypeValueTransfer',\n    TxTypeFeeDelegatedValueTransfer: 'TxTypeFeeDelegatedValueTransfer',\n    TxTypeFeeDelegatedValueTransferWithRatio: 'TxTypeFeeDelegatedValueTransferWithRatio',\n\n    TxTypeValueTransferMemo: 'TxTypeValueTransferMemo',\n    TxTypeFeeDelegatedValueTransferMemo: 'TxTypeFeeDelegatedValueTransferMemo',\n    TxTypeFeeDelegatedValueTransferMemoWithRatio: 'TxTypeFeeDelegatedValueTransferMemoWithRatio',\n\n    TxTypeAccountUpdate: 'TxTypeAccountUpdate',\n    TxTypeFeeDelegatedAccountUpdate: 'TxTypeFeeDelegatedAccountUpdate',\n    TxTypeFeeDelegatedAccountUpdateWithRatio: 'TxTypeFeeDelegatedAccountUpdateWithRatio',\n\n    TxTypeSmartContractDeploy: 'TxTypeSmartContractDeploy',\n    TxTypeFeeDelegatedSmartContractDeploy: 'TxTypeFeeDelegatedSmartContractDeploy',\n    TxTypeFeeDelegatedSmartContractDeployWithRatio: 'TxTypeFeeDelegatedSmartContractDeployWithRatio',\n\n    TxTypeSmartContractExecution: 'TxTypeSmartContractExecution',\n    TxTypeFeeDelegatedSmartContractExecution: 'TxTypeFeeDelegatedSmartContractExecution',\n    TxTypeFeeDelegatedSmartContractExecutionWithRatio: 'TxTypeFeeDelegatedSmartContractExecutionWithRatio',\n\n    TxTypeCancel: 'TxTypeCancel',\n    TxTypeFeeDelegatedCancel: 'TxTypeFeeDelegatedCancel',\n    TxTypeFeeDelegatedCancelWithRatio: 'TxTypeFeeDelegatedCancelWithRatio',\n\n    TxTypeChainDataAnchoring: 'TxTypeChainDataAnchoring',\n    TxTypeFeeDelegatedChainDataAnchoring: 'TxTypeFeeDelegatedChainDataAnchoring',\n    TxTypeFeeDelegatedChainDataAnchoringWithRatio: 'TxTypeFeeDelegatedChainDataAnchoringWithRatio',\n\n    TxTypeEthereumAccessList: 'TxTypeEthereumAccessList',\n    TxTypeEthereumDynamicFee: 'TxTypeEthereumDynamicFee',\n}\n\n/**\n * The transaction tag hex strings.\n * This is because the transaction type tag string and the transaction type string are mapped, so the transaction type tag can be used as a key value.\n *\n * @example\n * caver.transaction.tag.TxTypeLegacyTransaction // caver.transaction.tag['']\n * caver.transaction.tag.TxTypeValueTransfer // caver.transaction.tag['0x08']\n * caver.transaction.tag.TxTypeFeeDelegatedValueTransfer // caver.transaction.tag['0x09']\n * caver.transaction.tag.TxTypeFeeDelegatedValueTransferWithRatio // caver.transaction.tag['0x0a']\n * caver.transaction.tag.TxTypeValueTransferMemo // caver.transaction.tag['0x10']\n * caver.transaction.tag.TxTypeFeeDelegatedValueTransferMemo // caver.transaction.tag['0x11']\n * caver.transaction.tag.TxTypeFeeDelegatedValueTransferMemoWithRatio // caver.transaction.tag['0x12']\n * caver.transaction.tag.TxTypeAccountUpdate // caver.transaction.tag['0x20']\n * caver.transaction.tag.TxTypeFeeDelegatedAccountUpdate // caver.transaction.tag['0x21']\n * caver.transaction.tag.TxTypeFeeDelegatedAccountUpdateWithRatio // caver.transaction.tag['0x22']\n * caver.transaction.tag.TxTypeSmartContractDeploy // caver.transaction.tag['0x28']\n * caver.transaction.tag.TxTypeFeeDelegatedSmartContractDeploy // caver.transaction.tag['0x29']\n * caver.transaction.tag.TxTypeFeeDelegatedSmartContractDeployWithRatio // caver.transaction.tag['0x2a']\n * caver.transaction.tag.TxTypeSmartContractExecution // caver.transaction.tag['0x30']\n * caver.transaction.tag.TxTypeFeeDelegatedSmartContractExecution // caver.transaction.tag['0x31']\n * caver.transaction.tag.TxTypeFeeDelegatedSmartContractExecutionWithRatio // caver.transaction.tag['0x32']\n * caver.transaction.tag.TxTypeCancel // caver.transaction.tag['0x38']\n * caver.transaction.tag.TxTypeFeeDelegatedCancel // caver.transaction.tag['0x39']\n * caver.transaction.tag.TxTypeFeeDelegatedCancelWithRatio // caver.transaction.tag['0x3a']\n * caver.transaction.tag.TxTypeChainDataAnchoring // caver.transaction.tag['0x48']\n * caver.transaction.tag.TxTypeFeeDelegatedChainDataAnchoring // caver.transaction.tag['0x49']\n * caver.transaction.tag.TxTypeFeeDelegatedChainDataAnchoringWithRatio // caver.transaction.tag['0x4a']\n *\n * @alias module:Transaction.type\n * @type {Map<string:string>}\n */\nconst TX_TYPE_TAG = {\n    TxTypeLegacyTransaction: '',\n    '': TX_TYPE_STRING.TxTypeLegacyTransaction,\n\n    TxTypeValueTransfer: '0x08',\n    '0x08': TX_TYPE_STRING.TxTypeValueTransfer,\n    TxTypeFeeDelegatedValueTransfer: '0x09',\n    '0x09': TX_TYPE_STRING.TxTypeFeeDelegatedValueTransfer,\n    TxTypeFeeDelegatedValueTransferWithRatio: '0x0a',\n    '0x0a': TX_TYPE_STRING.TxTypeFeeDelegatedValueTransferWithRatio,\n\n    TxTypeValueTransferMemo: '0x10',\n    '0x10': TX_TYPE_STRING.TxTypeValueTransferMemo,\n    TxTypeFeeDelegatedValueTransferMemo: '0x11',\n    '0x11': TX_TYPE_STRING.TxTypeFeeDelegatedValueTransferMemo,\n    TxTypeFeeDelegatedValueTransferMemoWithRatio: '0x12',\n    '0x12': TX_TYPE_STRING.TxTypeFeeDelegatedValueTransferMemoWithRatio,\n\n    TxTypeAccountUpdate: '0x20',\n    '0x20': TX_TYPE_STRING.TxTypeAccountUpdate,\n    TxTypeFeeDelegatedAccountUpdate: '0x21',\n    '0x21': TX_TYPE_STRING.TxTypeFeeDelegatedAccountUpdate,\n    TxTypeFeeDelegatedAccountUpdateWithRatio: '0x22',\n    '0x22': TX_TYPE_STRING.TxTypeFeeDelegatedAccountUpdateWithRatio,\n\n    TxTypeSmartContractDeploy: '0x28',\n    '0x28': TX_TYPE_STRING.TxTypeSmartContractDeploy,\n    TxTypeFeeDelegatedSmartContractDeploy: '0x29',\n    '0x29': TX_TYPE_STRING.TxTypeFeeDelegatedSmartContractDeploy,\n    TxTypeFeeDelegatedSmartContractDeployWithRatio: '0x2a',\n    '0x2a': TX_TYPE_STRING.TxTypeFeeDelegatedSmartContractDeployWithRatio,\n\n    TxTypeSmartContractExecution: '0x30',\n    '0x30': TX_TYPE_STRING.TxTypeSmartContractExecution,\n    TxTypeFeeDelegatedSmartContractExecution: '0x31',\n    '0x31': TX_TYPE_STRING.TxTypeFeeDelegatedSmartContractExecution,\n    TxTypeFeeDelegatedSmartContractExecutionWithRatio: '0x32',\n    '0x32': TX_TYPE_STRING.TxTypeFeeDelegatedSmartContractExecutionWithRatio,\n\n    TxTypeCancel: '0x38',\n    '0x38': TX_TYPE_STRING.TxTypeCancel,\n    TxTypeFeeDelegatedCancel: '0x39',\n    '0x39': TX_TYPE_STRING.TxTypeFeeDelegatedCancel,\n    TxTypeFeeDelegatedCancelWithRatio: '0x3a',\n    '0x3a': TX_TYPE_STRING.TxTypeFeeDelegatedCancelWithRatio,\n\n    TxTypeChainDataAnchoring: '0x48',\n    '0x48': TX_TYPE_STRING.TxTypeChainDataAnchoring,\n    TxTypeFeeDelegatedChainDataAnchoring: '0x49',\n    '0x49': TX_TYPE_STRING.TxTypeFeeDelegatedChainDataAnchoring,\n    TxTypeFeeDelegatedChainDataAnchoringWithRatio: '0x4a',\n    '0x4a': TX_TYPE_STRING.TxTypeFeeDelegatedChainDataAnchoringWithRatio,\n\n    TxTypeEthereumAccessList: '0x7801',\n    '0x7801': TX_TYPE_STRING.TxTypeEthereumAccessList,\n    TxTypeEthereumDynamicFee: '0x7802',\n    '0x7802': TX_TYPE_STRING.TxTypeEthereumDynamicFee,\n}\n\nconst CODE_FORMAT = {\n    EVM: '0x0',\n}\n\n/**\n * Returns transaction type number.\n *\n * @param {string} type - A transaction type string.\n * @return {number}\n */\nconst getTypeInt = type => {\n    return utils.hexToNumber(TX_TYPE_TAG[type])\n}\n\n/**\n * Returns an EthereumTxTypeEnvelopeTag string.\n * This will be used to RLP encode ethereum typed transactions as a type prefix.\n *\n * @return {string}\n */\nconst getEthereumTxTypeEnvelopeTag = () => {\n    return '0x78'\n}\n\n/**\n * Returns an ethereum type tag without EthereumTxTypeEnvelopeTag('0x78').\n * This will be used to get RLP encoding to sign the ethereum typed transactions.\n *\n * @param {string} type - A transaction type string or tag.\n * @return {string}\n */\nconst getTypeTagWithoutEthereumTxTypeEnvelopeTag = type => {\n    if (!isEthereumTypedTxType(type)) throw new Error(`Not EthereumTxTypeEnvelope tx type: ${type}`)\n    let tag = type\n    if (type.startsWith('TxType')) tag = TX_TYPE_TAG[type]\n    return `0x${tag.replace(getEthereumTxTypeEnvelopeTag(), '')}`\n}\n\n/**\n * Returns whether the transaction type is ethereum tx or not.\n *\n * @param {string} type - A transaction type string or tag.\n * @return {boolean}\n */\nconst isEthereumTxType = txType => {\n    // The transaction types in `caver.transaction` should have tx type string as a member variable.\n    // So here we don't assume, user can define undefined for tx type.\n    if (txType === undefined) return false\n    return isLegacyTxType(txType) || isEthereumTypedTxType(txType)\n}\n\n/**\n * Returns whether the transaction type is legacy tx or not.\n *\n * @param {string} type - A transaction type string or tag.\n * @return {boolean}\n */\nconst isLegacyTxType = txType => {\n    // The transaction types in `caver.transaction` should have tx type string as a member variable.\n    // So here we don't assume, user can define undefined for tx type.\n    if (txType === undefined) return false\n    return txType === TX_TYPE_STRING.TxTypeLegacyTransaction || txType === TX_TYPE_TAG.TxTypeLegacyTransaction\n}\n\n/**\n * Returns the transaction type is ethereum typed tx or not.\n *\n * @param {string} type - A transaction type string or tag.\n * @return {boolean}\n */\nconst isEthereumTypedTxType = txType => {\n    // The transaction types in `caver.transaction` should have tx type string as a member variable.\n    // So here we don't assume, user can define undefined for tx type.\n    if (txType === undefined) return false\n    return (\n        txType.startsWith(getEthereumTxTypeEnvelopeTag()) ||\n        txType === TX_TYPE_STRING.TxTypeEthereumAccessList ||\n        txType === TX_TYPE_STRING.TxTypeEthereumDynamicFee\n    )\n}\n\n/**\n * Refines the array containing signatures.\n * - Removes duplicate signatures.\n * - Removes the default empty signature(['0x01', '0x', '0x']) included with other signatures.\n * - For an empty signature array, return an array containing the default empty signature(['0x01', '0x', '0x']).\n *\n * @param {Array.<string>|Array.<Array.<string>>|SignatureData|Array.<SignatureData>} sigArray - A signature or an array of signatures.\n * @param {string} [txType] - The transaction type string. This can be null if signature is not for transaction(for example message signed).\n * @return {SignatureData|Array.<SignatureData>}\n */\nconst refineSignatures = (sigArray, txType) => {\n    const set = new Set()\n    let result = []\n    const isSingleSignature = txType !== undefined ? isEthereumTxType(txType) : false\n\n    let arrayOfSignatures = sigArray\n    if (!_.isArray(sigArray) && sigArray instanceof SignatureData) {\n        arrayOfSignatures = [sigArray]\n    } else if (_.isArray(sigArray) && _.isString(sigArray[0])) {\n        arrayOfSignatures = [sigArray]\n    }\n    for (const sig of arrayOfSignatures) {\n        const signatureData = new SignatureData(sig)\n        if (!signatureData.isEmpty()) {\n            const sigString = sig.toString()\n            if (!set.has(sigString)) {\n                set.add(sigString, true)\n                result.push(signatureData)\n            }\n        }\n    }\n    if (result.length === 0) result = [SignatureData.emtpySig]\n\n    if (isSingleSignature && txType != undefined && result.length > 1) throw new Error(`${txType}} cannot have multiple sigantures.`)\n\n    return !isSingleSignature ? result : result[0]\n}\n\n/**\n * Returns transaction type string.\n *\n * @param {string} rlpEncoded - An RLP-encoded transaction string.\n * @return {string}\n */\nconst typeDetectionFromRLPEncoding = rlpEncoded => {\n    rlpEncoded = utils.addHexPrefix(rlpEncoded)\n    let typeTag\n    if (rlpEncoded.startsWith(getEthereumTxTypeEnvelopeTag())) {\n        typeTag = rlpEncoded.slice(0, 6)\n    } else {\n        typeTag = rlpEncoded.slice(0, 4)\n    }\n    return TX_TYPE_TAG[typeTag] ? TX_TYPE_TAG[typeTag] : TX_TYPE_STRING.TxTypeLegacyTransaction\n}\n\n/**\n * Returns code format tag string.\n *\n * @param {string|number} cf - The code format.\n * @return {string}\n */\nconst getCodeFormatTag = cf => {\n    if (cf === undefined) return CODE_FORMAT.EVM\n    switch (cf) {\n        case 0:\n        case '0x':\n        case '0x0':\n        case 'EVM':\n            return CODE_FORMAT.EVM\n    }\n    throw new Error(`Unsupported code format : ${cf}`)\n}\n\n/**\n * Returns `true` value is undefined or null.\n *\n * @param {*} value - The value to check.\n * @return {string}\n */\nconst isNot = function(value) {\n    return _.isUndefined(value) || _.isNull(value)\n}\n\nmodule.exports = {\n    TX_TYPE_STRING,\n    TX_TYPE_TAG,\n    CODE_FORMAT,\n    isNot,\n    refineSignatures,\n    typeDetectionFromRLPEncoding,\n    getCodeFormatTag,\n    getTypeInt,\n    isEthereumTxType,\n    isEthereumTypedTxType,\n    getEthereumTxTypeEnvelopeTag,\n    getTypeTagWithoutEthereumTxTypeEnvelopeTag,\n}\n"]},"metadata":{},"sourceType":"script"}